(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{303:function(e,t,a){Promise.resolve().then(a.bind(a,8836))},8836:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return d}});var r=a(3827),i=a(4090),o=a(1348),s=a(1840),n=a(2685);let l="https://chatfy.app.n8n.cloud/webhook-test/53267980-a99f-47fc-81ea-29bce15f1481";function d(){let[e,t]=(0,i.useState)(!1),[a,d]=(0,i.useState)(!1),[c,u]=(0,i.useState)([]),[m,p]=(0,i.useState)(""),[g,h]=(0,i.useState)(!1),[x,y]=(0,i.useState)(!1),[f,b]=(0,i.useState)(!1),w=(0,i.useRef)(null),v=(0,i.useRef)(null),[j,N]=(0,i.useState)(""),k=(0,i.useRef)(null);(0,i.useEffect)(()=>{var e;null===(e=w.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[c]),(0,i.useEffect)(()=>{try{let e=window.SpeechRecognition||window.webkitSpeechRecognition;if(e){let t=new e;t.continuous=!1,t.interimResults=!1,t.lang="pt-BR",t.onresult=e=>{let t=e.results[0][0].transcript;N(t),E(t)},t.onerror=e=>{console.error("Erro no reconhecimento de voz:",e.error),b(!1)},t.onend=()=>{b(!1)},k.current=t}}catch(e){console.error("Erro ao inicializar reconhecimento de voz:",e)}},[]);let D=e=>{d(!0),e&&(u([{id:Date.now(),text:e,isUser:!0,timestamp:new Date,isAudio:x}]),E(e)),setTimeout(()=>{t(!0),d(!1)},500)},E=async e=>{try{h(!0),console.log("Enviando mensagem para n8n:",e);let t=x?l:"https://chatfy.app.n8n.cloud/webhook-test/ebdcc93c-1fa0-4b18-8818-1af0b4db1303",a=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e,timestamp:new Date().toISOString(),isAudio:x,inputType:x?"audio":"text",messageType:x?"voice_message":"text_message"})});if(console.log("Status da resposta:",a.status),!a.ok)throw Error("Erro ao enviar mensagem para o n8n: ".concat(a.status));let r=await a.json();console.log("Resposta do n8n:",r);let i="",o="";r.audio||r.audioUrl||r.mp3||r.audioFile?(o=r.audio||r.audioUrl||r.mp3||r.audioFile,i="Resposta em \xe1udio",console.log("URL do \xe1udio detectada:",o)):r.data&&(r.data.audio||r.data.audioUrl||r.data.mp3||r.data.audioFile)?(o=r.data.audio||r.data.audioUrl||r.data.mp3||r.data.audioFile,i="Resposta em \xe1udio",console.log("URL do \xe1udio aninhada detectada:",o)):r.fileName&&r.fileName.includes(".mp3")?(i="Resposta em \xe1udio: ".concat(r.fileName),console.log("Arquivo de \xe1udio detectado:",r.fileName)):i=Array.isArray(r)?r.length>0&&r[0]&&r[0].output?r[0].output:r.map(e=>"string"==typeof e?e:JSON.stringify(e)).join("\n"):"object"==typeof r?r.output?r.output:r.response?r.response:r.message?r.message:r.text?r.text:r.data?"string"==typeof r.data?r.data:Array.isArray(r.data)&&r.data.length>0&&r.data[0].output?r.data[0].output:JSON.stringify(r.data):JSON.stringify(r):"string"==typeof r?r:JSON.stringify(r),console.log("Texto da resposta processado:",i);let s={id:Date.now(),text:i||"Desculpe, n\xe3o consegui processar sua mensagem.",isUser:!1,timestamp:new Date,isAudio:x||!!o,isPlaying:x||!!o,audioUrl:o||void 0};console.log("Adicionando mensagem ao chat:",s),u(e=>[...e,s]),o&&v.current?setTimeout(()=>{v.current&&(v.current.src=o,v.current.play().catch(e=>{console.error("Erro ao reproduzir \xe1udio:",e),setTimeout(()=>{u(e=>e.map(e=>e.id===s.id?{...e,isPlaying:!1}:e)),h(!1)},5e3)}),v.current.onended=()=>{u(e=>e.map(e=>e.id===s.id?{...e,isPlaying:!1}:e)),h(!1)})},500):x?setTimeout(()=>{u(e=>e.map(e=>e.id===s.id?{...e,isPlaying:!1}:e)),h(!1)},5e3):h(!1)}catch(t){console.error("Erro detalhado ao comunicar com n8n:",t);let e={id:Date.now(),text:"Desculpe, ocorreu um erro ao processar sua mensagem. Por favor, tente novamente.",isUser:!1,timestamp:new Date};u(t=>[...t,e]),h(!1)}finally{setTimeout(()=>{g&&h(!1)},1e4)}},U=async e=>{if(e.preventDefault(),!m.trim()||g)return;let t={id:Date.now(),text:m,isUser:!0,timestamp:new Date,isAudio:x};u(e=>[...e,t]),p(""),await E(m)},S=["Onde fica a loja Naturalys?","Qual o m\xe9todo de pagamento aceito na loja Naturalys?","Quais produtos s\xe3o vendidos na loja Naturalys?","A loja Naturalys oferece entrega?","Quais s\xe3o os hor\xe1rios de funcionamento da loja Naturalys?","A loja Naturalys tem produtos org\xe2nicos?","A loja Naturalys faz descontos?","A loja Naturalys tem programa de fidelidade?","A loja Naturalys aceita cart\xf5es de cr\xe9dito?","A loja Naturalys tem estacionamento?","A loja Naturalys faz entregas em toda a cidade?","A loja Naturalys tem produtos importados?"],A=[...S,...S],T=async()=>{if(console.log("=== IN\xcdCIO DO TESTE DE \xc1UDIO ==="),g){console.log("Bloqueado: j\xe1 est\xe1 carregando");return}h(!0);let e=new AbortController,t=setTimeout(()=>e.abort(),3e4);try{let a,r;let i={message:"Teste de \xe1udio",timestamp:new Date().toISOString(),isAudio:!0,inputType:"audio",messageType:"voice_message",sessionId:Date.now().toString(),userId:"test-user",platform:"web",test:!0},o={id:Date.now(),text:"Teste de \xe1udio",isUser:!0,timestamp:new Date,isAudio:!0};u(e=>[...e,o]);let s=await fetch(l,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json, audio/mp3, audio/*"},body:JSON.stringify(i),signal:e.signal});if(clearTimeout(t),!s.ok){let e=await s.text();throw Error("Erro ".concat(s.status,": ").concat(e))}let n=s.headers.get("content-type");if(console.log("Tipo de conte\xfado recebido:",n),null==n?void 0:n.includes("audio/"))a=await s.blob(),r=URL.createObjectURL(a);else{let e=await s.json();if(console.log("Dados recebidos:",e),e.data&&e.data.binary){let t=atob(e.data.binary),i=new Uint8Array(t.length);for(let e=0;e<t.length;e++)i[e]=t.charCodeAt(e);a=new Blob([i],{type:"audio/mp3"}),r=URL.createObjectURL(a)}else(e.audio||e.audioUrl||e.mp3)&&(r=e.audio||e.audioUrl||e.mp3)}if(!r)throw Error("Nenhum \xe1udio recebido na resposta");let d={id:Date.now()+1,text:"Resposta em \xe1udio",isUser:!1,timestamp:new Date,isAudio:!0,isPlaying:!0,audioUrl:r};if(u(e=>[...e,d]),v.current)try{v.current.src=r,await v.current.play(),v.current.onended=()=>{URL.revokeObjectURL(r),u(e=>e.map(e=>e.id===d.id?{...e,isPlaying:!1}:e)),h(!1)},v.current.onerror=e=>{console.error("Erro na reprodu\xe7\xe3o do \xe1udio:",e),URL.revokeObjectURL(r),u(e=>e.map(e=>e.id===d.id?{...e,isPlaying:!1}:e)),h(!1)}}catch(e){console.error("Erro ao reproduzir \xe1udio:",e),URL.revokeObjectURL(r),setTimeout(()=>{u(e=>e.map(e=>e.id===d.id?{...e,isPlaying:!1}:e)),h(!1)},5e3)}}catch(e){clearTimeout(t),console.error("Erro no teste de \xe1udio:",e),u(t=>[...t,{id:Date.now(),text:e instanceof Error&&"AbortError"===e.name?"Tempo limite excedido. Por favor, tente novamente.":"Erro ao processar mensagem de teste. Por favor, tente novamente.",isUser:!1,timestamp:new Date}]),h(!1)}};return(0,r.jsxs)("main",{className:"min-h-screen bg-white relative",children:[(0,r.jsx)("audio",{ref:v,className:"hidden"}),(0,r.jsx)(o.M,{children:!e&&(0,r.jsxs)(s.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0,y:-20},transition:{duration:.5},className:"flex flex-col items-center justify-center min-h-screen p-4",children:[(0,r.jsx)("div",{className:"absolute top-6 left-0 right-0 flex justify-center z-10",children:(0,r.jsx)("div",{className:"bg-very-light-green rounded-full p-1 shadow-md border border-light-green",children:(0,r.jsxs)("div",{className:"relative flex items-center",children:[(0,r.jsx)(s.E.div,{className:"absolute inset-0 z-0",initial:!1,animate:{x:x?"100%":"0%",width:"50%"},transition:{type:"spring",stiffness:300,damping:30},style:{height:"85%",top:"7.5%"},children:(0,r.jsx)("div",{className:"w-full h-full bg-primary-green rounded-full"})}),(0,r.jsxs)("button",{onClick:()=>y(!1),className:"relative z-10 py-1.5 px-4 rounded-full transition-all duration-300 flex items-center ".concat(x?"text-dark-green":"text-white font-medium"),children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4 mr-1",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9 12.75 3 3m0 0 3-3m-3 3v-7.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),"Texto"]}),(0,r.jsxs)("button",{onClick:()=>y(!0),className:"relative z-10 py-1.5 px-4 rounded-full transition-all duration-300 flex items-center ".concat(x?"text-white font-medium":"text-dark-green"),children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4 mr-1",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18.75a6 6 0 0 0 6-6v-1.5m-6 7.5a6 6 0 0 1-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 0 1-3-3V4.5a3 3 0 1 1 6 0v8.25a3 3 0 0 1-3 3Z"})}),"\xc1udio"]})]})})}),(0,r.jsxs)(s.E.div,{initial:{y:-30,opacity:0},animate:{y:0,opacity:1},exit:{y:-30,opacity:0},transition:{duration:.5},className:"text-center mb-10",children:[(0,r.jsx)("h1",{className:"text-5xl font-bold bg-gradient-to-r from-dark-green via-primary-green to-light-green bg-[length:200%_auto] bg-clip-text text-transparent animate-gradient mb-4",children:"Oi, sou a Mari"}),(0,r.jsx)("p",{className:"text-gray text-lg",children:"Seu assistente de IA inteligente para ajudar no seu dia a dia"})]}),x?(0,r.jsxs)(s.E.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"flex flex-col items-center justify-center mb-12",children:[(0,r.jsx)("style",{children:"\n  @keyframes pulse {\n    0%, 100% { transform: scale(1); opacity: 0.8; }\n    50% { transform: scale(1.1); opacity: 1; }\n  }\n"}),(0,r.jsxs)("div",{className:"relative w-48 h-48 flex items-center justify-center",children:[(0,r.jsxs)(s.E.div,{className:"absolute w-32 h-32 bg-gradient-to-br from-primary-green to-dark-green rounded-full shadow-lg",style:{boxShadow:"0 0 20px rgba(76, 175, 80, 0.3)"},animate:{scale:[1,1.05,1],opacity:[.8,1,.8]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:[(0,r.jsx)("div",{className:"absolute inset-0 rounded-full bg-white opacity-20 blur-sm"}),(0,r.jsx)("div",{className:"absolute -inset-2 rounded-full bg-primary-green opacity-20 blur-md",style:{animation:"pulse 2s ease-in-out infinite"}})]}),g&&(0,r.jsx)("div",{className:"absolute -bottom-8 text-sm text-gray-600 font-medium",children:"Processando..."})]})]}):(0,r.jsx)(s.E.div,{className:"w-full max-w-4xl mb-8 overflow-hidden",exit:{opacity:0,y:20},transition:{duration:.5,delay:.2},children:[0,1,2].map(e=>(0,r.jsx)(s.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},transition:{delay:.2*e},className:"flex mb-4 relative",children:(0,r.jsxs)("div",{className:"flex animate-slide-row ".concat(1===e?"animate-slide-row-reverse":""),style:{animationDuration:"".concat(30+5*e,"s"),width:"200%"},children:[A.slice(4*e,(e+1)*4).map((e,t)=>(0,r.jsx)(s.E.button,{whileHover:{scale:1.05,y:-3},className:"bg-very-light-green text-dark-green px-6 py-2 rounded-full mx-2 whitespace-nowrap border border-light-green shadow-sm hover:bg-primary-green hover:text-white transition-all flex-shrink-0",onClick:()=>D(e),children:e},t)),A.slice(4*e,(e+1)*4).map((e,t)=>(0,r.jsx)(s.E.button,{whileHover:{scale:1.05,y:-3},className:"bg-very-light-green text-dark-green px-6 py-2 rounded-full mx-2 whitespace-nowrap border border-light-green shadow-sm hover:bg-primary-green hover:text-white transition-all flex-shrink-0",onClick:()=>D(e),children:e},"dup-".concat(t)))]})},e))}),(0,r.jsx)(s.E.div,{className:"fixed bottom-0 left-0 right-0 p-4 bg-white/80 backdrop-blur-sm",exit:{opacity:0,y:20},transition:{duration:.5,delay:.4},children:(0,r.jsxs)("div",{className:"max-w-xl mx-auto",children:[(0,r.jsx)("p",{className:"text-gray text-center mb-2 animate-pulse-slow",children:x?"Clique no bot\xe3o para enviar um \xe1udio":"Digite uma pergunta para iniciar a conversa"}),(0,r.jsx)("form",{onSubmit:U,className:"relative",children:x?(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsxs)("button",{type:"button",disabled:g,onClick:T,className:"relative w-20 h-20 rounded-full ".concat(g?"bg-gray":"bg-primary-green hover:bg-dark-green"," transition-colors shadow-lg disabled:opacity-50 disabled:cursor-not-allowed"),children:[g&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"absolute inset-0 rounded-full bg-primary-green/20 animate-ping",style:{animationDuration:"1.5s"}}),(0,r.jsx)("div",{className:"absolute inset-0 rounded-full bg-primary-green/30 animate-ping",style:{animationDuration:"2s",animationDelay:"0.3s"}}),(0,r.jsx)("div",{className:"absolute inset-0 rounded-full bg-primary-green/10 animate-ping",style:{animationDuration:"2.5s",animationDelay:"0.6s"}})]}),(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"white",className:"w-8 h-8 absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18.75a6 6 0 0 0 6-6v-1.5m-6 7.5a6 6 0 0 1-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 0 1-3-3V4.5a3 3 0 1 1 6 0v8.25a3 3 0 0 1-3 3Z"})})]})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("input",{type:"text",value:m,onChange:e=>p(e.target.value),placeholder:"Digite sua pergunta ou t\xf3pico para come\xe7ar...",className:"w-full px-6 py-4 rounded-full border-2 border-light-green focus:border-primary-green focus:ring-2 focus:ring-primary-green/20 outline-none shadow-lg",onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),D(m))}}),(0,r.jsx)("button",{type:"submit",className:"absolute right-2 top-1/2 -translate-y-1/2 bg-primary-green text-white p-2 rounded-full hover:bg-dark-green transition-colors",children:(0,r.jsx)(n.Z,{className:"w-6 h-6"})})]})})]})})]})}),e&&(0,r.jsxs)(s.E.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"flex flex-col h-screen",children:[(0,r.jsxs)("div",{className:"p-4 bg-white border-b border-light-green flex justify-between items-center",children:[(0,r.jsx)("div",{className:"w-1/3"}),(0,r.jsx)("div",{className:"w-1/3 text-center",children:(0,r.jsx)("div",{className:"inline-flex px-3 py-1 rounded-full text-sm font-medium ".concat(x?"bg-dark-green":"bg-primary-green"," text-white border ").concat(x?"border-light-green":"border-dark-green"," shadow-sm items-center"),children:x?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4 mr-1",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18.75a6 6 0 0 0 6-6v-1.5m-6 7.5a6 6 0 0 1-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 0 1-3-3V4.5a3 3 0 1 1 6 0v8.25a3 3 0 0 1-3 3Z"})}),"Modo \xc1udio"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4 mr-1",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9 12.75 3 3m0 0 3-3m-3 3v-7.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),"Modo Texto"]})})}),(0,r.jsx)("div",{className:"w-1/3 flex justify-end",children:(0,r.jsx)("h2",{className:"text-lg font-semibold text-primary-green",children:"Mari AI"})})]}),(0,r.jsx)("div",{className:"flex-1 p-4 overflow-y-auto",children:c.map(e=>(0,r.jsx)("div",{className:"flex ".concat(e.isUser?"justify-end":"justify-start"),children:(0,r.jsx)("div",{className:"max-w-md p-2 rounded-lg bg-very-light-green",children:e.text})},e.id))}),(0,r.jsx)("div",{className:"p-4 bg-white",children:(0,r.jsx)("form",{onSubmit:U,className:"relative",children:x?(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsxs)("button",{type:"button",disabled:g,onClick:T,className:"relative w-20 h-20 rounded-full ".concat(g?"bg-gray":"bg-primary-green hover:bg-dark-green"," transition-colors shadow-lg disabled:opacity-50 disabled:cursor-not-allowed"),children:[g&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"absolute inset-0 rounded-full bg-primary-green/20 animate-ping",style:{animationDuration:"1.5s"}}),(0,r.jsx)("div",{className:"absolute inset-0 rounded-full bg-primary-green/30 animate-ping",style:{animationDuration:"2s",animationDelay:"0.3s"}}),(0,r.jsx)("div",{className:"absolute inset-0 rounded-full bg-primary-green/10 animate-ping",style:{animationDuration:"2.5s",animationDelay:"0.6s"}})]}),(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"white",className:"w-8 h-8 absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18.75a6 6 0 0 0 6-6v-1.5m-6 7.5a6 6 0 0 1-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 0 1-3-3V4.5a3 3 0 1 1 6 0v8.25a3 3 0 0 1-3 3Z"})})]})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("input",{type:"text",value:m,onChange:e=>p(e.target.value),placeholder:"Digite sua pergunta ou t\xf3pico para come\xe7ar...",className:"w-full px-6 py-4 rounded-full border-2 border-light-green focus:border-primary-green focus:ring-2 focus:ring-primary-green/20 outline-none shadow-lg",onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),D(m))}}),(0,r.jsx)("button",{type:"submit",className:"absolute right-2 top-1/2 -translate-y-1/2 bg-primary-green text-white p-2 rounded-full hover:bg-dark-green transition-colors",children:(0,r.jsx)(n.Z,{className:"w-6 h-6"})})]})})})]})]})}}},function(e){e.O(0,[61,971,69,744],function(){return e(e.s=303)}),_N_E=e.O()}]);